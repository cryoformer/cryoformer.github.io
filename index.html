<!DOCTYPE html>
<html><head lang="en"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="x-ua-compatible" content="ie=edge">

    <title>CryoFormer</title>

    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <!-- mirror: F0%9F%AA%9E&lt -->
    <link rel="icon" type="image/png" href="img_cryoformer/protein_1.png">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/codemirror.min.css">
    <link rel="stylesheet" href="css/app.css">

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/codemirror.min.js"></script>
    <script src="js/clipboard.min.js"></script>
    <script src="js/video_comparison.js"></script>
    <script src="js/app.js"></script>
</head>

<body>
    <div class="container" id="header" style="text-align: center; margin: auto;">
        <div class="row" id="title-row" style="max-width: 100%; margin: 0 auto; display: inline-block">
            <h2 class="col-md-12 text-center" id="title">
                <b>CryoFormer</b>:  Continuous Heterogeneous Cryo-EM Reconstruction<br> using Transformer-based Neural Representations <br> 
            </h2>
        </div>
                <div class="author-list">
                    <div class="author">
                        <a href="https://xinhangliu.com">Xinhang Liu*</a>
                    </div>
                    <div class="author">
                        Yan Zeng*
                    </div>
                    <div class="author">
                        Yifan Qin
                    </div>
                    <div class="author">
                        Hao Li
                    </div>
                    
                    <div class="author">
                        <a href="https://jiakai-zhang.github.io/">Jiakai Zhang</a>
                    </div>
                    <div class="author">
                        <a href="http:/xu-lan.com/">Lan Xu</a>
                    </div>
                    <div class="author">
                        <a href="https://sist.shanghaitech.edu.cn/sist_en/2020/0814/c7582a54832/page.htm">Jingyi Yu</a>
                    </div>
                </div>
                <div class="author-list">* denotes equal contribution.</div>
    </div>
    <script>
        document.getElementById('author-row').style.maxWidth = document.getElementById("title-row").clientWidth + 'px';
    </script>
    <div class="container" id="main">
        <div class="row">
                <div class="col-sm-8 col-sm-offset-2 text-center">
                    <ul class="nav nav-pills nav-justified">
                        <li>
                            <a href="https://arxiv.org/abs/2303.16254" target="_blank">
                                <img src="./img_cryoformer/file.png" height="60px"><br>
                                <strong>Paper</strong>
                            </a>
                          </li>                        
                        <li>
                            <a href="https://youtu.be/U4b_NxDyJGE" target="_blank">
                                <img src="./img_cryoformer/video-player.png" height="60px"><br>
                                <strong>Video</strong>
                            </a>
                        </li>
                        <li>
                            <a href="https://cryoformer.github.io/" target="_blank">
                                <img src="./img_cryoformer/protein.png" height="60px"><br>
                              <strong>Dataset<br>(coming soon)</strong>
                            </a>
                          </li>                        
                        <li>
                            <a href="https://cryoformer.github.io/" target="_blank">
                                <img src="./img_cryoformer/code.png" height="60px"><br>
                                <strong>Code<br>(coming soon)</strong>
                            </a>
                        </li>
                    </ul>
                </div>
        </div>



     

        <div class="row">
            
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Abstract
                </h3>
                <p class="text-justify">
                    Cryo-electron microscopy (cryo-EM) allows for the high-resolution reconstruction 
                    of 3D structures of proteins and other biomolecules. Successful reconstruction 
                    of both shape and movement greatly helps understand the fundamental processes of 
                    life. However, it is still challenging to reconstruct the continuous motions of 3D
                     structures from hundreds of thousands of noisy and randomly oriented 2D cryo-EM 
                     images. Recent advancements use Fourier domain coordinate-based neural networks to
                      continuously model 3D conformations, yet they often struggle to capture local 
                      flexible regions accurately. We propose CryoFormer, a new approach for continuous 
                      heterogeneous cryo-EM reconstruction. Our approach leverages an implicit feature 
                      volume directly in the real domain as the 3D representation. We further introduce 
                      a novel query-based deformation transformer decoder to improve the reconstruction 
                      quality. Our approach is capable of refining pre-computed pose estimations and 
                      locating flexible regions. In experiments, our method outperforms current approaches 
                      on three public datasets (1 synthetic and 2 experimental) and a new synthetic dataset 
                      of PEDV spike protein. 
                </p>
            </div>
        </div>
    </div>
</div>

<img src="img_cryoformer/arch.png" class="img-responsive" alt="overview" style="max-width: 60%; height: auto; display: block; margin: auto;">

        

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Video
                </h3>
                <div class="text-center">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/fSxdsiP_2DM?si=Cogx_al3ZxTY6eBz" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
                </div>
            </div>
        </div>

        
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Continuous Modeling of Conformational Heterogeneity
                </h3>
                <div class="text-justify">
                    Using a transformer-based neural representation built in the spatial domain, cryoFormer is capable of continuously modeling the conformational heterogeneity, while recovering fine details of structures.
                </div>
                <div class="text-center">
                    <video id="refdir" width="60%" playsinline autoplay loop muted>
                        <source src="video/7w_01.mp4" type="video/mp4" />
                    </video>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Visualization of 3D Attention Maps
                </h3>
                <div class="text-justify">
                    We map the value in the 3D attention map to the surface color of the reconstructed volume.
                    The displayed channel of the 3D attention map captures information about the flexible regions of the PEDV spike.
                <div class="text-center">
                    <video id="refdir" width="80%" playsinline autoplay loop muted>
                        <source src="video/attention.mp4" type="video/mp4" />
                    </video>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Comparison with Baselines on Synthetic Datasets
                </h3>
                <div class="text-justify">
                    We compare CryoFormer with CryoDRGN and SFBP on PEDV. On CryoDRGN Synthetic Dataset, CryoFormer reconstructed volumes qualitatively match the ground truth and baselines' reconstructed
                    structures, with better recovery of details. 
                </div>
                <div class="text-center">
                    <video id="refdir" width="80%" playsinline autoplay loop muted>
                        <source src="video/flower.mp4" type="video/mp4" />
                    </video>
                </div>
                <div class="text-justify">
                    On PEDV spike synthetic dataset, with SNR = 0.01. 
                    The volumes reconstructed by CryoFormer exhibit better restoration of details than the baselines.
                </div>
                <div class="text-center">
                    <video id="refdir" width="80%" playsinline autoplay loop muted>
                        <source src="video/7w_snr.mp4" type="video/mp4" />
                    </video>
                </div>
            </div>
        </div>

       

         <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Reconstruction on Real Experimental Datasets
                </h3>
                <div class="text-justify">
                    We evaluate our approach on an experimental dataset of 80S ribosome from EMPIAR-10028. 
                    Our method manages to recover the shape and integrity of detailed structures like the 
                    α-helices in contrast to baseline approaches.
                </div>
                <div class="text-center">
                    <video id="refdir" width="80%" playsinline autoplay loop muted>
                        <source src="video/10028-page.mp4" type="video/mp4" />
                    </video>
                </div>
                <div class="text-justify">
                    On EMPIAR-10180 (a pre-catalytic spliceosome), our method manages to maintain structural integrity 
                    during dynamic processes, while our reconstructions exhibit a clear outline of the secondary structure.
                </div>
                <div class="text-center">
                    <video id="refdir" width="80%" playsinline autoplay loop muted>
                        <source src="video/10180-page.mp4" type="video/mp4" />
                    </video>
                </div>
            </div>
        </div>

        


            
        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Citation
                </h3>
                <div class="form-group col-md-10 col-md-offset-1">
                    <textarea id="bibtex" class="form-control" readonly>
@misc{cryoformer,
    title={CryoFormer: Continuous Heterogeneous Cryo-EM Reconstruction using Transformer-based Neural Representations}, 
    author={Xinhang Liu and Yan Zeng and Yifan Qin and Hao Li and Jiakai Zhang and Lan Xu and Jingyi Yu},
    year={2023},
    eprint={2303.16254},
    archivePrefix={arXiv},
    primaryClass={cs.CV}
}
</textarea>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8 col-md-offset-2">
                <h3>
                    Acknowledgements
                </h3>
                <p class="text-justify">
                <!-- We would like to thank Lior Yariv and Kai Zhang for helping us evaluate their methods, and Ricardo Martin-Brualla for helpful comments on our text. DV is supported by the National Science Foundation under Cooperative Agreement PHY-2019786 (an NSF AI Institute, <a href="http://iaifi.org">http://iaifi.org</a>)
                    <br> -->
                The website template was borrowed from <a href="http://mgharbi.com/">Michaël Gharbi</a>.
                </p>
            </div>
        </div>
    </div>


</body></html>
